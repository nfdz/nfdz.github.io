<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Foco | nfdz</title><meta name=keywords content="android,open-source"><meta name=description content="Minimalist text editor"><meta name=author content="nfdz"><link rel=canonical href=https://nfdz.io/posts/2017/foco/><link crossorigin=anonymous href=/assets/css/stylesheet.4398b09e795c3aac93a04f4160281925a588bcdf14941ead87ab7bfe555ba854.css integrity="sha256-Q5iwnnlcOqyToE9BYCgZJaWIvN8UlB6th6t7/lVbqFQ=" rel="preload stylesheet" as=style><link rel=icon href=https://nfdz.io/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://nfdz.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://nfdz.io/favicon-32x32.png><link rel=apple-touch-icon href=https://nfdz.io/apple-touch-icon.png><link rel=mask-icon href=https://nfdz.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script src=https://cdn.counter.dev/script.js data-id=e8c4ac17-b831-4d09-99fc-d5c9883f0baf data-utcoffset=2></script>
<script src=/js/header_console.js></script><meta property="og:title" content="Foco"><meta property="og:description" content="Minimalist text editor"><meta property="og:type" content="article"><meta property="og:url" content="https://nfdz.io/posts/2017/foco/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-08-06T00:00:00+00:00"><meta property="article:modified_time" content="2017-08-06T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Foco"><meta name=twitter:description content="Minimalist text editor"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://nfdz.io/posts/"},{"@type":"ListItem","position":2,"name":"Foco","item":"https://nfdz.io/posts/2017/foco/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Foco","name":"Foco","description":"Minimalist text editor","keywords":["android","open-source"],"articleBody":"This is a writing application without distractions and fuss, easy to use and tiny.\nKey Features Markdown support. Writing statistics: time, words count. Ambient music. Right to left support. Import and Export. Storage friendly. Favorite files. Search. Battery friendly. Markdown helper: H1, H2 and H3 Bold, italic and strikethrough Quote List (bulleted and numbered) Link Image and video (Youtube) Motivation I wanted to learn and use new patterns and libraries on Android. On the one hand I wanted to use the new Android Design Support Library.\nOn the other hand, I wanted to try the new Android Architecture Components. They are a new collection of libraries that help design robust, testable, and maintainable apps.\nWhen I saw the announcement on the Google I/O 2017 I was totally sure that I was going to try as soon as I could in my next project.\nFinally, I also wanted to include in the application a background music player since I had never worked with anything like that on Android.\nConcept It must implement all the required features in an intuitive and transparent way. elaborate a mockup to follow in its development.\nBefore the development, I have developed a sketch mockup to test the different features and the user experience.\nImplementation The MainActivity is the entry point of the application and shows all available documents in a grid. To do this, it uses a RecyclerView. There is a bottom toolbar that appears when any document is selected. It is possible to change the order and filter.\nThe EditDocActivity is where the user can edit a document and visualize its preview. The CustomEditText view has been used for editing. This class extends EditText and adds the functionality to add a listener to receive the selection change events. This was necessary to be able to offer a bottom toolbar with markdown format editing shortcuts.\nFor the preview has been used MarkdownView that is a view defined in a third-party library with the same name. It is very useful since it is easy to use and very powerful. It supports several markdown formats and nice CSS themes.\nThe cover of a document can be a flat color or a custom image. The EditDocCoverDialog implements this cover settings. It could be presented as a dialog or as a full screen fragment depending on the device.\nThe view of this dialog has two tabs. The first one shows the selected cover color and it can be modified using the Material Color Picker Dialog. The second one shows the selected cover image and it can be modified using File Picker Dialog. It is executed a post-selection process of the image to reduce and optimize it. It achieves it by using the Picasso and the Compressor libraries.\nThe MusicDialog shows a simple ambient music control. It is connected to the MusicService to retrieve playback information and to perform actions.\nThe MusicService is a bound service. It is responsible for managing the playback of the ambient music. It uses a MusicPlayer. The ambient music are pre-stored tracks to play in a loop. It is possible to interact with this service through intent actions and its bind interface.\nThe service manages and controls a notification while there is music playing. This notification has actions that use PendingIntent to control the playback.\nAndroid Architecture Components I used of Room for the data persistence. Room provides an abstraction layer over SQLite to allow fluent database access while taking advantage of the powerful SQLite. There is a Data Access Object (DAO) interface called DocumentDao. For example, it has this method to get a document:\n1 2 @Query(\"SELECT * FROM \" + TABLE_NAME + \" WHERE \" + COLUMN_ID + \" = :docId\") DocumentEntity getDocument(long docId); There is an Entity class called DocumentEntity. It implements the Document interface from the domain and it has all attributes column names defined there. The DocumentMetadata class contains all attributes of DocumentEntity but the text of the document. This is useful in order to retrieve a list of documents avoiding loading in memory each document. Room deals with any class that it could match the column names with class attributes. For example, to get a document metadata the DocumentDao method is:\n1 2 3 4 5 6 7 8 9 10 11 12 @Query(\"SELECT \" + COLUMN_ID + \", \" + COLUMN_NAME + \", \" + COLUMN_WORKING_TIME + \", \" + COLUMN_LAST_EDITION_TIME + \", \" + COLUMN_WORDS + \", \" + COLUMN_FAVORITE + \", \" + COLUMN_COVER_COLOR + \", \" + COLUMN_COVER_IMAGE + \" FROM \" + TABLE_NAME + \" WHERE \" + COLUMN_ID + \" = :docId\") DocumentMetadata getDocumentMetadata(long docId); The database that stores this DAO is defined in the AppDatabase. It is singleton with the purpose of accessing and creating the database. The instance is created by using Room:\n1 sInstance = Room.databaseBuilder(context, AppDatabase.class, DATABASE_NAME).build(); The DocListViewModel, that extends the ViewModel class, manages the access of the data from the view classes attached to the Android life cycle. It offers a LiveData that contains a list of DocumentMetadata. In order to consume the DocListViewModel I had to do the following:\n1 2 3 4 5 6 7 DocListViewModel viewModel = ViewModelProviders.of(this).get(DocListViewModel.class); viewModel.getDocumentsMetadata().observe(this, new Observer\u003e() { @Override public void onChanged(@Nullable List docs) { // do something ... } }); As you can see, it is no longer necessary to mess with AsyncTask to load the data asynchronously nor manual cache to avoid load the data again with configuration changes. These new components own that complexity in a transparent way.\nDependencies The 3rd party software that I have used for the application is:\nButter Knife: Bind Android views and callbacks to fields and methods. Timber: A logger with a small, extensible API which provides utility on top of Androidâ€™s normal Log class. Picasso: A powerful image downloading and caching library for Android. 1 2 3 4 5 6 7 8 Picasso.with(getActivity()) .load(new File(mImagePath)) .placeholder(R.drawable.image_placeholder) .memoryPolicy(MemoryPolicy.NO_CACHE) .resize(IMAGE_MAX_WIDTH_PX, IMAGE_MAX_HEIGHT_PX) .centerInside() .onlyScaleDown() .into(mImageView); Material Color Picker Dialog: A simple, minimalistic and beautiful dialog color picker. 1 2 3 4 5 6 7 8 9 10 11 final ColorPicker cp = new ColorPicker(getActivity(), Color.red(currentColor), Color.green(currentColor), Color.blue(currentColor)); cp.show(); cp.setCallback(new ColorPickerCallback() { @Override public void onColorChosen(@ColorInt int color) { // do something ... } }); FilePicker: A simple and minimalistic file picker dialog. 1 2 3 4 5 6 7 8 9 10 DialogProperties properties = new DialogProperties(); ... FilePickerDialog dialog = new FilePickerDialog(getActivity(), properties); dialog.setDialogSelectionListener(new DialogSelectionListener() { @Override public void onSelectedFilePaths(String[] files) { // do something ... } }); dialog.show(); Compressor: An Android image compression library. 1 2 3 4 5 6 7 File compressedImage = new Compressor(getActivity()) .setMaxWidth(IMAGE_MAX_WIDTH_PX) .setMaxHeight(IMAGE_MAX_HEIGHT_PX) .setQuality(IMAGE_QUALITY) .setCompressFormat(Bitmap.CompressFormat.JPEG) .setDestinationDirectoryPath(directory.getAbsolutePath()) .compressToFile(new File(image), name); MarkdownView: An Android library to display markdown text in a beautiful way. Conclusion Thanks to this project I have been able to learn a lot. I liked working with the new Android Architecture Components and in my opinion they have a great future ahead.\nThe result is very close to the initial mockup and most of the features are implemented. I think it meets the requirements and I hope it is useful.\nThe application is free software, GPLv3, you can see the code on GitHub and download the APK from the Releases page.\n","wordCount":"1204","inLanguage":"en","datePublished":"2017-08-06T00:00:00Z","dateModified":"2017-08-06T00:00:00Z","author":{"@type":"Person","name":"nfdz"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://nfdz.io/posts/2017/foco/"},"publisher":{"@type":"Organization","name":"nfdz","logo":{"@type":"ImageObject","url":"https://nfdz.io/images/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://nfdz.io/ accesskey=h title="nfdz (Alt + H)">nfdz</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://nfdz.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://nfdz.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://nfdz.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://github.com/nfdz title=Projects><span>Projects</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Foco</h1><div class=post-description>Minimalist text editor</div><div class=post-meta><span title='2017-08-06 00:00:00 +0000 UTC'>August 6, 2017</span>&nbsp;Â·&nbsp;6 min&nbsp;Â·&nbsp;nfdz</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#key-features aria-label="Key Features">Key Features</a></li><li><a href=#motivation aria-label=Motivation>Motivation</a></li><li><a href=#concept aria-label=Concept>Concept</a></li><li><a href=#implementation aria-label=Implementation>Implementation</a><ul><li><a href=#android-architecture-components aria-label="Android Architecture Components">Android Architecture Components</a></li><li><a href=#dependencies aria-label=Dependencies>Dependencies</a></li></ul></li><li><a href=#conclusion aria-label=Conclusion>Conclusion</a></li></ul></div></details></div><div class=post-content><p>This is a writing application without distractions and fuss, easy to use and tiny.</p><h2 id=key-features>Key Features<a hidden class=anchor aria-hidden=true href=#key-features>#</a></h2><ul><li>Markdown support.</li><li>Writing statistics: time, words count.</li><li>Ambient music.</li><li>Right to left support.</li><li>Import and Export.</li><li>Storage friendly.</li><li>Favorite files.</li><li>Search.</li><li>Battery friendly.</li><li>Markdown helper:<ul><li>H1, H2 and H3</li><li>Bold, italic and strikethrough</li><li>Quote</li><li>List (bulleted and numbered)</li><li>Link</li><li>Image and video (Youtube)</li></ul></li></ul><h2 id=motivation>Motivation<a hidden class=anchor aria-hidden=true href=#motivation>#</a></h2><p>I wanted to learn and use new patterns and libraries on Android. On the one hand I wanted to use the new <a href=https://developer.android.com/topic/libraries/support-library/features#material-design target=_blank>Android Design Support Library</a>.</p><p>On the other hand, I wanted to try the new <a href=https://developer.android.com/jetpack/guide target=_blank>Android Architecture Components</a>. They are a new collection of libraries that help design robust, testable, and maintainable apps.</p><p>When I saw the announcement on the <a href="https://www.youtube.com/watch?v=FrteWKKVyzI" target=_blank>Google I/O 2017</a> I was totally sure that I was going to try as soon as I could in my next project.</p><blockquote><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube-nocookie.com/embed/vOJCrbr144o style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></blockquote><p>Finally, I also wanted to include in the application a background music player since I had never worked with anything like that on Android.</p><h2 id=concept>Concept<a hidden class=anchor aria-hidden=true href=#concept>#</a></h2><p>It must implement all the required features in an intuitive and transparent way. elaborate a mockup to follow in its development.</p><p>Before the development, I have developed a sketch mockup to test the different features and the user experience.</p><p><img loading=lazy src=../images/foco/mockup.png alt=Mockup></p><h2 id=implementation>Implementation<a hidden class=anchor aria-hidden=true href=#implementation>#</a></h2><p>The <code>MainActivity</code> is the entry point of the application and shows all available documents in a grid. To do this, it uses a <code>RecyclerView</code>. There is a bottom toolbar that appears when any document is selected. It is possible to change the order and filter.</p><p><img loading=lazy src=../images/foco/MainActivity-screenshots.png alt=MainActivity></p><p>The <code>EditDocActivity</code> is where the user can edit a document and visualize its preview. The <code>CustomEditText</code> view has been used for editing. This class extends <code>EditText</code> and adds the functionality to add a listener to receive the selection change events. This was necessary to be able to offer a bottom toolbar with markdown format editing shortcuts.</p><p><img loading=lazy src=../images/foco/EditDocActivity-edit-screenshots.png alt="EditDocActivity edit"></p><p>For the preview has been used <code>MarkdownView</code> that is a view defined in a third-party library with the same name. It is very useful since it is easy to use and very powerful. It supports several markdown formats and nice CSS themes.</p><p><img loading=lazy src=../images/foco/EditDocActivity-preview-screenshots.png alt="EditDocActivity preview"></p><p>The cover of a document can be a flat color or a custom image. The <code>EditDocCoverDialog</code> implements this cover settings. It could be presented as a dialog or as a full screen fragment depending on the device.</p><p>The view of this dialog has two tabs. The first one shows the selected cover color and it can be modified using the <code>Material Color Picker Dialog</code>. The second one shows the selected cover image and it can be modified using <code>File Picker Dialog</code>. It is executed a post-selection process of the image to reduce and optimize it. It achieves it by using the <code>Picasso</code> and the <code>Compressor</code> libraries.</p><p><img loading=lazy src=../images/foco/EditDocCoverDialog-screenshots.png alt=EditDocCoverDialog></p><p>The <code>MusicDialog</code> shows a simple ambient music control. It is connected to the <code>MusicService</code> to retrieve playback information and to perform actions.</p><p><img loading=lazy src=../images/foco/MusicDialog-screenshot.png alt=MusicDialog></p><p>The <code>MusicService</code> is a bound service. It is responsible for managing the playback of the ambient music. It uses a <code>MusicPlayer</code>. The ambient music are pre-stored tracks to play in a loop. It is possible to interact with this service through intent actions and its bind interface.</p><p>The service manages and controls a notification while there is music playing. This notification has actions that use <code>PendingIntent</code> to control the playback.</p><p><img loading=lazy src=../images/foco/MusicService-notification.png alt=MusicService></p><h3 id=android-architecture-components>Android Architecture Components<a hidden class=anchor aria-hidden=true href=#android-architecture-components>#</a></h3><p>I used of Room for the data persistence. Room provides an abstraction layer over SQLite to allow fluent database access while taking advantage of the powerful SQLite. There is a Data Access Object (DAO) interface called <code>DocumentDao</code>. For example, it has this method to get a document:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Query</span><span class=o>(</span><span class=s>&#34;SELECT * FROM &#34;</span> <span class=o>+</span> <span class=n>TABLE_NAME</span> <span class=o>+</span> <span class=s>&#34; WHERE &#34;</span> <span class=o>+</span> <span class=n>COLUMN_ID</span> <span class=o>+</span> <span class=s>&#34; = :docId&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>DocumentEntity</span> <span class=nf>getDocument</span><span class=o>(</span><span class=kt>long</span> <span class=n>docId</span><span class=o>);</span>
</span></span></code></pre></td></tr></table></div></div><p>There is an Entity class called <code>DocumentEntity</code>. It implements the <code>Document</code> interface from the domain and it has all attributes column names defined there. The <code>DocumentMetadata</code> class contains all attributes of <code>DocumentEntity</code> but the text of the document. This is useful in order to retrieve a list of documents avoiding loading in memory each document. Room deals with any class that it could match the column names with class attributes. For example, to get a document metadata the <code>DocumentDao</code> method is:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Query</span><span class=o>(</span><span class=s>&#34;SELECT &#34;</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>       <span class=n>COLUMN_ID</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>       <span class=n>COLUMN_NAME</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>       <span class=n>COLUMN_WORKING_TIME</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>       <span class=n>COLUMN_LAST_EDITION_TIME</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>       <span class=n>COLUMN_WORDS</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>       <span class=n>COLUMN_FAVORITE</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>       <span class=n>COLUMN_COVER_COLOR</span> <span class=o>+</span>  <span class=s>&#34;, &#34;</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>       <span class=n>COLUMN_COVER_IMAGE</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>       <span class=s>&#34; FROM &#34;</span> <span class=o>+</span> <span class=n>TABLE_NAME</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34; WHERE &#34;</span> <span class=o>+</span> <span class=n>COLUMN_ID</span> <span class=o>+</span> <span class=s>&#34; = :docId&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>DocumentMetadata</span> <span class=nf>getDocumentMetadata</span><span class=o>(</span><span class=kt>long</span> <span class=n>docId</span><span class=o>);</span>
</span></span></code></pre></td></tr></table></div></div><p>The database that stores this DAO is defined in the <code>AppDatabase</code>. It is singleton with the purpose of accessing and creating the database. The instance is created by using Room:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>sInstance</span> <span class=o>=</span> <span class=n>Room</span><span class=o>.</span><span class=na>databaseBuilder</span><span class=o>(</span><span class=n>context</span><span class=o>,</span> <span class=n>AppDatabase</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>DATABASE_NAME</span><span class=o>).</span><span class=na>build</span><span class=o>();</span>
</span></span></code></pre></td></tr></table></div></div><p>The <code>DocListViewModel</code>, that extends the <code>ViewModel</code> class, manages the access of the data from the view classes attached to the Android life cycle. It offers a <code>LiveData</code> that contains a list of <code>DocumentMetadata</code>. In order to consume the <code>DocListViewModel</code> I had to do the following:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>DocListViewModel</span> <span class=n>viewModel</span> <span class=o>=</span> <span class=n>ViewModelProviders</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=k>this</span><span class=o>).</span><span class=na>get</span><span class=o>(</span><span class=n>DocListViewModel</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>viewModel</span><span class=o>.</span><span class=na>getDocumentsMetadata</span><span class=o>().</span><span class=na>observe</span><span class=o>(</span><span class=k>this</span><span class=o>,</span> <span class=k>new</span> <span class=n>Observer</span><span class=o>&gt;()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onChanged</span><span class=o>(</span><span class=nd>@Nullable</span> <span class=n>List</span> <span class=n>docs</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// do something ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>});</span>
</span></span></code></pre></td></tr></table></div></div><p>As you can see, it is no longer necessary to mess with <code>AsyncTask</code> to load the data asynchronously nor manual cache to avoid load the data again with configuration changes. These new components own that complexity in a transparent way.</p><h3 id=dependencies>Dependencies<a hidden class=anchor aria-hidden=true href=#dependencies>#</a></h3><p>The 3rd party software that I have used for the application is:</p><ul><li><a href=http://jakewharton.github.io/butterknife/ target=_blank>Butter Knife</a>: Bind Android views and callbacks to fields and methods.</li><li><a href=https://github.com/JakeWharton/timber target=_blank>Timber</a>: A logger with a small, extensible API which provides utility on top of Android&rsquo;s normal Log class.</li><li><a href=http://square.github.io/picasso target=_blank>Picasso</a>: A powerful image downloading and caching library for Android.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Picasso</span><span class=o>.</span><span class=na>with</span><span class=o>(</span><span class=n>getActivity</span><span class=o>())</span>
</span></span><span class=line><span class=cl>    <span class=o>.</span><span class=na>load</span><span class=o>(</span><span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=n>mImagePath</span><span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=o>.</span><span class=na>placeholder</span><span class=o>(</span><span class=n>R</span><span class=o>.</span><span class=na>drawable</span><span class=o>.</span><span class=na>image_placeholder</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>.</span><span class=na>memoryPolicy</span><span class=o>(</span><span class=n>MemoryPolicy</span><span class=o>.</span><span class=na>NO_CACHE</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>.</span><span class=na>resize</span><span class=o>(</span><span class=n>IMAGE_MAX_WIDTH_PX</span><span class=o>,</span> <span class=n>IMAGE_MAX_HEIGHT_PX</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>.</span><span class=na>centerInside</span><span class=o>()</span>
</span></span><span class=line><span class=cl>    <span class=o>.</span><span class=na>onlyScaleDown</span><span class=o>()</span>
</span></span><span class=line><span class=cl>    <span class=o>.</span><span class=na>into</span><span class=o>(</span><span class=n>mImageView</span><span class=o>);</span>
</span></span></code></pre></td></tr></table></div></div></li><li><a href=https://github.com/Pes8/android-material-color-picker-dialog target=_blank>Material Color Picker Dialog</a>: A simple, minimalistic and beautiful dialog color picker.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>final</span> <span class=n>ColorPicker</span> <span class=n>cp</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ColorPicker</span><span class=o>(</span><span class=n>getActivity</span><span class=o>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>Color</span><span class=o>.</span><span class=na>red</span><span class=o>(</span><span class=n>currentColor</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>Color</span><span class=o>.</span><span class=na>green</span><span class=o>(</span><span class=n>currentColor</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>Color</span><span class=o>.</span><span class=na>blue</span><span class=o>(</span><span class=n>currentColor</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>cp</span><span class=o>.</span><span class=na>show</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>cp</span><span class=o>.</span><span class=na>setCallback</span><span class=o>(</span><span class=k>new</span> <span class=n>ColorPickerCallback</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=nd>@Override</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>onColorChosen</span><span class=o>(</span><span class=nd>@ColorInt</span> <span class=kt>int</span> <span class=n>color</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// do something ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>});</span>
</span></span></code></pre></td></tr></table></div></div></li><li><a href=https://github.com/Angads25/android-filepicker target=_blank>FilePicker</a>: A simple and minimalistic file picker dialog.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>DialogProperties</span> <span class=n>properties</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DialogProperties</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=n>FilePickerDialog</span> <span class=n>dialog</span> <span class=o>=</span> <span class=k>new</span> <span class=n>FilePickerDialog</span><span class=o>(</span><span class=n>getActivity</span><span class=o>(),</span> <span class=n>properties</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>dialog</span><span class=o>.</span><span class=na>setDialogSelectionListener</span><span class=o>(</span><span class=k>new</span> <span class=n>DialogSelectionListener</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=nd>@Override</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>onSelectedFilePaths</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>files</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// do something ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>});</span>
</span></span><span class=line><span class=cl><span class=n>dialog</span><span class=o>.</span><span class=na>show</span><span class=o>();</span>
</span></span></code></pre></td></tr></table></div></div></li><li><a href=https://github.com/zetbaitsu/Compressor target=_blank>Compressor</a>: An Android image compression library.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>File</span> <span class=n>compressedImage</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Compressor</span><span class=o>(</span><span class=n>getActivity</span><span class=o>())</span>
</span></span><span class=line><span class=cl>    <span class=o>.</span><span class=na>setMaxWidth</span><span class=o>(</span><span class=n>IMAGE_MAX_WIDTH_PX</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>.</span><span class=na>setMaxHeight</span><span class=o>(</span><span class=n>IMAGE_MAX_HEIGHT_PX</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>.</span><span class=na>setQuality</span><span class=o>(</span><span class=n>IMAGE_QUALITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>.</span><span class=na>setCompressFormat</span><span class=o>(</span><span class=n>Bitmap</span><span class=o>.</span><span class=na>CompressFormat</span><span class=o>.</span><span class=na>JPEG</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>.</span><span class=na>setDestinationDirectoryPath</span><span class=o>(</span><span class=n>directory</span><span class=o>.</span><span class=na>getAbsolutePath</span><span class=o>())</span>
</span></span><span class=line><span class=cl>    <span class=o>.</span><span class=na>compressToFile</span><span class=o>(</span><span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=n>image</span><span class=o>),</span> <span class=n>name</span><span class=o>);</span>
</span></span></code></pre></td></tr></table></div></div></li><li><a href=https://github.com/tiagohm/MarkdownView target=_blank>MarkdownView</a>: An Android library to display markdown text in a beautiful way.</li></ul><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Thanks to this project I have been able to learn a lot. I liked working with the new Android Architecture Components and in my opinion they have a great future ahead.</p><p>The result is very close to the initial mockup and most of the features are implemented. I think it meets the requirements and I hope it is useful.</p><p>The application is free software, GPLv3, you can see the code on <a href=https://github.com/nfdz/foco target=_blank>GitHub</a> and download the APK from the <a href=https://github.com/nfdz/foco/releases target=_blank>Releases</a> page.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://nfdz.io/tags/android/>android</a></li><li><a href=https://nfdz.io/tags/open-source/>open-source</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://nfdz.io/>nfdz</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>